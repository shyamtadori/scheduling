<ol class="breadcrumb">
  <li><%= link_to "Manage Hitches", hitches_path %></li>
  <li class="active">Editing Hitch <%= link_to @hitch.name, @hitch %></li>
</ol>
<div class="row">
  <div class="col-md-12">
    <h2>Hitch <%= @hitch.name %></h2>
    <hr>
  </div>
</div>
<div class="row">
  <div class="col-md-8">
    <div class="panel panel-primary">
      <div class="panel-heading">
        <div class="row">
          <div class="col-sm-8">Associated Pilots</div>
          <div class="col-sm-4 float-right" id="hitch-search-container"></div>
        </div>
      </div>
      <div class="panel-body">
        <div class="row expaneded">
          <div class="col-sm-12">
            <div class="row">
              <div class="col-sm-6">
                <button type="button" data-url-path="#" class="btn btn-default filter_status" id="associated_pilot_status"><%= 'Active' %></button>
              </div>
              <div class="col-sm-6">
                <%= link_to add_pilots_hitch_path(@hitch), class: 'btn btn-info float-right' do %>
                  <i class="fa fa-plus-square" aria-hidden="true"></i>
                  Add Pilots
                <% end %>
              </div>    
            </div>
          
          <% if @pilots_hitches.present? %>
            <table class='table table-striped datatable'>
              <thead>
                <tr>
                  <th>Last Name</th>
                  <th>First Name</th>
                  <th>Start Date</th>
                  <th>End Date</th>
                  <th></th>
                  <th></th>
                </tr>
              </thead>

              <tbody>
                <% @pilots_hitches.each do |pilots_hitch| %>
                  <tr>
                    <td><%= pilots_hitch.pilot.last_name %></td>
                    <td><%= pilots_hitch.pilot.first_name %></td>
                    <td><%= date_format(pilots_hitch.effective_start_date) %>
                    </td>
                    <td><%= date_format(pilots_hitch.effective_end_date) %>
                    </td>
                    <td><%= link_to 'Switch Hitches', switch_hitch_pilots_hitch_path(@hitch, pilots_hitch), class: "modal-link", data: {action: 'switch', pilot_hitch_id: pilots_hitch.id} %></td>
                    <td><%= link_to 'Edit', edit_hitch_pilots_hitch_path(@hitch, pilots_hitch) , class: "modal-link", data: {action: 'edit', pilot_hitch_id: pilots_hitch.id}%></td>
                    <td><%= link_to 'Remove from hitch', hitch_pilots_hitch_path(@hitch, pilots_hitch), method: :delete, data: { confirm: 'Are you sure?' } %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          <% else %>
            <h3>No Pilots found</h3>
          <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="panel panel-default float-left width-100">
      <div class="panel-heading float-left width-100">
        Details
        <%= link_to edit_hitch_path(@hitch), class: 'btn btn-default float-right' do %> 
            <i class="fa fa-pencil" aria-hidden="true"></i>
            Edit
          <% end %>
      </div>
        <!-- /.panel-heading -->
      <div class="panel-body float-left width-100">
        <div class="list-group">
            <span class="list-group-item">
              <i class="fa fa-braille fa-fw"></i> Name
              <span class="pull-right text-muted small"><em><%= @hitch.name %></em>
              </span>
            </span>
            <span class="list-group-item">
              <% if @hitch.work_type == 'week_days' %>
                <i class="fa fa-calendar-check-o fa-fw"></i> Work Days
                <span class="pull-right text-muted small">
                  <em class="no-wrap">
                    <span class='label label-<%= @hitch.mon ? "primary" : "default" %>'>Mon</span>
                    <span class='label label-<%= @hitch.tue ? "primary" : "default" %>'>Tue</span>
                    <span class='label label-<%= @hitch.wed ? "primary" : "default" %>'>Wed</span>
                    <span class='label label-<%= @hitch.thu ? "primary" : "default" %>'>Thu</span>
                    <span class='label label-<%= @hitch.fri ? "primary" : "default" %>'>Fri</span>
                    <span class='label label-<%= @hitch.sat ? "primary" : "default" %>'>Sat</span>
                    <span class='label label-<%= @hitch.sun ? "primary" : "default" %>'>Sun</span>
                  </em>
                </span>
              <% else %>
                <i class="fa fa-calendar-check-o fa-fw"></i> Days On/Off
                <span class="pull-right text-muted small"><em><%= @hitch.days_on %>/<%= @hitch.days_off %></em>
                </span>
              <% end %>
            </span>
            <span class="list-group-item">
                <i class="fa fa-clock-o fa-fw"></i> Hour Start
                <span class="pull-right text-muted small"><em><%= time_format(@hitch.hour_start) %></em>
                </span>
            </span>
            <span class="list-group-item">
                <i class="fa fa-clock-o fa-fw"></i> Hour End
                <span class="pull-right text-muted small"><em><%= time_format(@hitch.hour_end) %></em>
                </span>
            </span>
            <span class="list-group-item">
                <i class="fa fa-user fa-fw"></i> Create By
                <span class="pull-right text-muted small"><em><%= @hitch.created_user_name %></em>
                </span>
            </span>
            <span class="list-group-item">
                <i class="fa fa-calendar fa-fw"></i> Creation Date
                <span class="pull-right text-muted small"><em><%= date_format(@hitch.creation_date) %></em>
                </span>
            </span>
            <span class="list-group-item">
                <i class="fa fa-user fa-fw"></i> Last Updated By
                <span class="pull-right text-muted small"><em><%= @hitch.last_updated_user_name %></em>
                </span>
            </span>
            <span class="list-group-item">
                <i class="fa fa-calendar fa-fw"></i> Last Updated At
                <span class="pull-right text-muted small"><em><%= date_format(@hitch.last_update_date) %></em>
                </span>
            </span>
        </div>
        <!-- /.list-group -->
      </div>
      <!-- /.panel-body -->
    </div>
  </div>
</div>
<div class="modal fade pilot_hitch_edit" tabindex="-1" role="dialog" aria-labelledby="pilot_hitch_edit_modal" id='edit_modal'>
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      
    </div>
  </div>
</div>
<script>
  $(function(){
    $('.modal-link').on('click', function(e){
      e.preventDefault();
      $('#edit_modal').modal('show').find('.modal-content').load($(this).attr('href'));
    })
  });
</script>